{
    "openapi": "3.0.2",
    "info": {
        "title": "ontology-manager-relation-type",
        "version": "1.0.0"
    },
    "paths": {
        "/api/ontology-manager/v1/knowledge-networks/{kn_id}/relation_paths": {
            "summary": "查询两个类之间的关联路径",
            "description": "查询两个类之间的关联路径",
            "post": {
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RelationPathReqeustBody"
                            }
                        }
                    },
                    "required": true
                },
                "parameters": [
                    {
                        "name": "kn_id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Path"
                                    }
                                }
                            }
                        },
                        "description": "ok"
                    }
                },
                "summary": "查询两个类之间的关联路径",
                "description": "查询两个类之间的关联路径"
            },
            "parameters": [
                {
                    "name": "kn_id",
                    "in": "path",
                    "required": true
                }
            ]
        },
        "/api/ontology-manager/v1/knowledge-networks/{kn_id}/relation-types": {
            "get": {
                "parameters": [
                    {
                        "name": "kn_id",
                        "description": "业务知识网络ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "name_pattern",
                        "description": "根据络名称模糊查询，默认为空",
                        "schema": {
                            "type": "string"
                        },
                        "in": "query"
                    },
                    {
                        "name": "sort",
                        "description": "排序类型，默认是update_time",
                        "schema": {
                            "enum": [
                                "update_time",
                                "name"
                            ],
                            "type": "string"
                        },
                        "in": "query"
                    },
                    {
                        "name": "direction",
                        "description": "排序结果方向，可选asc、desc。\n默认desc",
                        "schema": {
                            "enum": [
                                "asc",
                                "desc"
                            ],
                            "type": "string"
                        },
                        "in": "query"
                    },
                    {
                        "name": "offset",
                        "description": "开始响应的项目的偏移量\t\n范围需大于等于0，默认值0",
                        "schema": {
                            "format": "int64",
                            "type": "integer"
                        },
                        "in": "query"
                    },
                    {
                        "name": "limit",
                        "description": "每页最多可返回的项目数；\n分页可选1-1000，-1表示不分页；\n默认值10",
                        "schema": {
                            "format": "int64",
                            "type": "integer"
                        },
                        "in": "query"
                    },
                    {
                        "name": "tag",
                        "description": "根据标签精准查询，默认为空.",
                        "schema": {
                            "type": "string"
                        },
                        "in": "query"
                    },
                    {
                        "name": "group_id",
                        "description": "按概念分组过滤",
                        "schema": {
                            "type": "string"
                        },
                        "in": "query"
                    },
                    {
                        "name": "source_object_type_id",
                        "description": "起点对象类ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "query"
                    },
                    {
                        "name": "target_object_type_id",
                        "description": "终点对象类ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ListRelationTypes"
                                }
                            }
                        },
                        "description": "ok"
                    }
                },
                "summary": "获取关系类列表"
            },
            "post": {
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/override"
                            },
                            "examples": {
                                "创建关系类": {
                                    "value": [
                                        {
                                            "id": "service_2_pod",
                                            "name": "包含",
                                            "tags": [
                                                "拓扑架构"
                                            ],
                                            "comment": "服务到pod的关系，服务包含于pod",
                                            "icon": "",
                                            "color": "",
                                            "branch": "main",
                                            "source_object_type_id": "service",
                                            "target_object_type_id": "pod",
                                            "type": "direct",
                                            "mapping_rules": [
                                                {
                                                    "source_property": {
                                                        "name": "service_name"
                                                    },
                                                    "target_property": {
                                                        "name": "service_name"
                                                    }
                                                }
                                            ],
                                            "module_type": "relation_type"
                                        },
                                        {
                                            "id": "pod_2_node",
                                            "name": "属于",
                                            "tags": [
                                                "拓扑架构"
                                            ],
                                            "comment": "pod到node的关系，pod包含于节点",
                                            "icon": "",
                                            "color": "",
                                            "branch": "main",
                                            "source_object_type_id": "pod",
                                            "target_object_type_id": "node",
                                            "type": "direct",
                                            "mapping_rules": [
                                                {
                                                    "source_property": {
                                                        "name": "pod_node_name"
                                                    },
                                                    "target_property": {
                                                        "name": "node_name"
                                                    }
                                                }
                                            ],
                                            "module_type": "relation_type"
                                        }
                                    ]
                                },
                                "检索关系类-第一次请求": {
                                    "value": {
                                        "need_total": true,
                                        "limit": 1,
                                        "condition": {
                                            "operation": "and",
                                            "sub_conditions": [
                                                {
                                                    "field": "comment",
                                                    "operation": "match",
                                                    "value_from": "const",
                                                    "value": "pod"
                                                },
                                                {
                                                    "field": "*",
                                                    "operation": "knn",
                                                    "value_from": "const",
                                                    "value": [
                                                        "pod",
                                                        10
                                                    ]
                                                }
                                            ]
                                        }
                                    }
                                },
                                "检索关系类-非第一次": {
                                    "value": {
                                        "search_after": [
                                            3.7951493,
                                            "pod_2_node_TEST"
                                        ],
                                        "need_total": true,
                                        "limit": 1,
                                        "condition": {
                                            "operation": "and",
                                            "sub_conditions": [
                                                {
                                                    "field": "comment",
                                                    "operation": "match",
                                                    "value_from": "const",
                                                    "value": "pod"
                                                },
                                                {
                                                    "field": "*",
                                                    "operation": "knn",
                                                    "value_from": "const",
                                                    "value": [
                                                        "pod",
                                                        10
                                                    ]
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "required": true
                },
                "parameters": [
                    {
                        "name": "kn_id",
                        "description": "业务知识网络ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "x-http-method-override",
                        "description": "重载请求头",
                        "schema": {
                            "enum": [
                                "POST",
                                "GET"
                            ],
                            "type": "string"
                        },
                        "in": "header",
                        "required": true
                    }
                ],
                "responses": {
                    "201": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/ID"
                                    }
                                }
                            }
                        },
                        "description": "ok"
                    },
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/RelationTypeSearchResponse"
                                },
                                "examples": {
                                    "检索关系类-第一次请求": {
                                        "value": {
                                            "entries": [
                                                {
                                                    "id": "pod_2_node_TEST",
                                                    "name": "属于2",
                                                    "tags": [
                                                        "拓扑架构"
                                                    ],
                                                    "comment": "pod到node的关系，pod包含于节点",
                                                    "icon": "",
                                                    "color": "",
                                                    "branch": "main",
                                                    "detail": "",
                                                    "creator": "a0f02238-6cec-11f0-82bb-fa1c4529a151",
                                                    "create_time": 1758339660119,
                                                    "updater": "a0f02238-6cec-11f0-82bb-fa1c4529a151",
                                                    "update_time": 1758339660119,
                                                    "kn_id": "kn_system_incident_event_network",
                                                    "source_object_type_id": "pod",
                                                    "source_object_type": {
                                                        "id": "",
                                                        "name": "",
                                                        "icon": "",
                                                        "color": ""
                                                    },
                                                    "target_object_type_id": "node",
                                                    "target_object_type": {
                                                        "id": "",
                                                        "name": "",
                                                        "icon": "",
                                                        "color": ""
                                                    },
                                                    "type": "direct",
                                                    "mapping_rules": [
                                                        {
                                                            "source_property": {
                                                                "name": "pod_node_name"
                                                            },
                                                            "target_property": {
                                                                "name": "node_name"
                                                            }
                                                        }
                                                    ],
                                                    "IfNameModify": false,
                                                    "module_type": "relation_type"
                                                }
                                            ],
                                            "total_count": 2,
                                            "search_after": [
                                                3.7951493,
                                                "pod_2_node_TEST"
                                            ]
                                        }
                                    },
                                    "检索关系类--非第一次请求": {
                                        "value": {
                                            "entries": [
                                                {
                                                    "id": "service_2_pod_test",
                                                    "name": "包含2",
                                                    "tags": [
                                                        "拓扑架构"
                                                    ],
                                                    "comment": "服务到pod的关系，服务包含于pod",
                                                    "icon": "",
                                                    "color": "",
                                                    "branch": "main",
                                                    "detail": "",
                                                    "creator": "a0f02238-6cec-11f0-82bb-fa1c4529a151",
                                                    "create_time": 1758339660119,
                                                    "updater": "a0f02238-6cec-11f0-82bb-fa1c4529a151",
                                                    "update_time": 1758339660119,
                                                    "kn_id": "kn_system_incident_event_network",
                                                    "source_object_type_id": "service",
                                                    "source_object_type": {
                                                        "id": "",
                                                        "name": "",
                                                        "icon": "",
                                                        "color": ""
                                                    },
                                                    "target_object_type_id": "pod",
                                                    "target_object_type": {
                                                        "id": "",
                                                        "name": "",
                                                        "icon": "",
                                                        "color": ""
                                                    },
                                                    "type": "direct",
                                                    "mapping_rules": [
                                                        {
                                                            "source_property": {
                                                                "name": "service_name"
                                                            },
                                                            "target_property": {
                                                                "name": "service_name"
                                                            }
                                                        }
                                                    ],
                                                    "IfNameModify": false,
                                                    "module_type": "relation_type"
                                                }
                                            ],
                                            "search_after": [
                                                3.782332,
                                                "service_2_pod_test"
                                            ]
                                        }
                                    }
                                }
                            }
                        },
                        "description": "重载GET, 检索关系类"
                    }
                },
                "summary": "创建或检索关系类"
            },
            "parameters": [
                {
                    "name": "kn_id",
                    "description": "业务知识网络ID",
                    "schema": {
                        "type": "string"
                    },
                    "in": "path",
                    "required": true
                }
            ]
        },
        "/api/ontology-manager/v1/knowledge-networks/{kn_id}/relation-types/{rt_id}": {
            "put": {
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpdateRelationType"
                            }
                        }
                    },
                    "required": true
                },
                "parameters": [
                    {
                        "name": "kn_id",
                        "description": "业务知识网络ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "rt_id",
                        "description": "关系类ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "204": {
                        "description": "ok"
                    }
                },
                "summary": "修改关系类"
            },
            "parameters": [
                {
                    "name": "kn_id",
                    "description": "业务知识网络ID",
                    "schema": {
                        "type": "string"
                    },
                    "in": "path",
                    "required": true
                },
                {
                    "name": "rt_id",
                    "description": "关系类ID",
                    "schema": {
                        "type": "string"
                    },
                    "in": "path",
                    "required": true
                }
            ]
        },
        "/api/ontology-manager/v1/knowledge-networks/{kn_id}/relation-types/{rt_ids}": {
            "get": {
                "parameters": [
                    {
                        "name": "rt_ids",
                        "description": "关系类ID",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "kn_id",
                        "description": "业务知识网络ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "include_detail",
                        "description": "是否包含说明书信息，默认false，不包含。",
                        "schema": {
                            "type": "boolean"
                        },
                        "in": "query"
                    }
                ],
                "responses": {
                    "200": {
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/RelationTypeDetail"
                                    }
                                }
                            }
                        },
                        "description": "ok"
                    }
                },
                "summary": "获取关系类详情"
            },
            "delete": {
                "parameters": [
                    {
                        "name": "kn_id",
                        "description": "业务知识网络ID",
                        "schema": {
                            "type": "string"
                        },
                        "in": "path",
                        "required": true
                    },
                    {
                        "name": "rt_ids",
                        "description": "关系类ID",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "204": {
                        "description": "ok"
                    }
                },
                "summary": "删除关系类"
            },
            "parameters": [
                {
                    "name": "kn_id",
                    "description": "业务知识网络ID",
                    "schema": {
                        "type": "string"
                    },
                    "in": "path",
                    "required": true
                },
                {
                    "name": "rt_ids",
                    "description": "关系类ID",
                    "schema": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "in": "path",
                    "required": true
                }
            ]
        }
    },
    "components": {
        "schemas": {
            "BasicInfo": {
                "description": "资源的基本信息，包含id和名称",
                "required": [
                    "id",
                    "name"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "description": "资源ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "资源名称",
                        "type": "string"
                    }
                }
            },
            "ConceptCondition": {
                "description": "概念查询数据条件。可用于过滤的字段有类名、属性名和描述",
                "required": [
                    "operation"
                ],
                "type": "object",
                "properties": {
                    "field": {
                        "description": "字段名称",
                        "enum": [
                            "type_id",
                            "type_name",
                            "property_name",
                            "property_display_name",
                            "comment"
                        ],
                        "type": "string"
                    },
                    "operation": {
                        "description": "操作符。\n\nknn: 未对原文进行向量化的向量过滤，接收的值是数组，第一个值，过滤内容，第二个值为 int,是邻居搜索时返回的邻居个数。\n\nknn_vector: 对原文进行向量化后的向量过滤，接收的值是数组，第一个值，向量，第二个值为 int,是邻居搜索时返回的邻居个数。",
                        "enum": [
                            "and",
                            "or",
                            "==",
                            "!=",
                            "in",
                            "not_in",
                            "like",
                            "not_like",
                            "regex",
                            "match",
                            "match_phrase",
                            "knn",
                            "knn_vector"
                        ],
                        "type": "string"
                    },
                    "sub_conditions": {
                        "description": "子过滤条件",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ConceptCondition"
                        }
                    },
                    "value": {
                        "description": "字段值"
                    },
                    "value_from": {
                        "description": "字段值来源，当前仅支持 \"const\"",
                        "enum": [
                            "const"
                        ],
                        "type": "string"
                    }
                }
            },
            "ConceptGroup": {
                "description": "概念分组",
                "required": [
                    "id",
                    "name"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "description": "概念分组ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "概念分组名称",
                        "type": "string"
                    }
                }
            },
            "DataSource": {
                "description": "数据来源",
                "required": [
                    "type",
                    "id"
                ],
                "type": "object",
                "properties": {
                    "type": {
                        "description": "数据来源类型为数据视图",
                        "enum": [
                            "data_view"
                        ],
                        "type": "string"
                    },
                    "id": {
                        "description": "数据视图ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "数据视图名称。查看详情时返回。",
                        "type": "string"
                    }
                }
            },
            "DataViewMappingRule": {
                "description": "关系类型为 data_view 时的匹配规则",
                "required": [
                    "backing_data_source",
                    "source_mapping_rules",
                    "target_mapping_rules"
                ],
                "type": "object",
                "properties": {
                    "backing_data_source": {
                        "$ref": "#/components/schemas/DataSource",
                        "description": "数据来源视图"
                    },
                    "source_mapping_rules": {
                        "description": "起点对象类与数据集的匹配规则",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/Mapping"
                        }
                    },
                    "target_mapping_rules": {
                        "description": "终点对象类与数据集匹配规则",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/Mapping"
                        }
                    }
                }
            },
            "RelationPathReqeustBody": {
                "description": "路径查询的请求体",
                "required": [
                    "start_object_type",
                    "end_object_type",
                    "path_max_length",
                    "direction",
                    "source_object_type"
                ],
                "type": "object",
                "properties": {
                    "concept_groups": {
                        "description": "概念分组id",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "source_object_type": {
                        "description": "起点对象类ID",
                        "type": "string"
                    },
                    "target_object_type": {
                        "description": "终点对象类ID。当终点类不为空时，查找两个对象类之间的路径；当终点类为空时，从起点类按路径长度查找关联的所有的点",
                        "type": "string"
                    },
                    "path_max_length": {
                        "description": "最大路径长度,不超过5.",
                        "type": "integer"
                    },
                    "direction": {
                        "description": "方向：正向(forward)、反向(reverse)、双向(bidirectional)",
                        "enum": [
                            "forward",
                            "reverse",
                            "bidirectional"
                        ],
                        "type": "string"
                    },
                    "path_select_policy": {
                        "description": "路径选择策略。多路径下选择路径的条件或规则，不给则把所有的关系都返回。当前需求不给，策略未来再设计实现",
                        "type": "string"
                    }
                }
            },
            "ID": {
                "description": "id",
                "required": [
                    "id"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "description": "id",
                        "type": "string"
                    }
                }
            },
            "ListRelationTypes": {
                "description": "关系类列表",
                "required": [
                    "entries",
                    "total_count"
                ],
                "type": "object",
                "properties": {
                    "entries": {
                        "description": "条目列表",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/RelationType"
                        }
                    },
                    "total_count": {
                        "description": "总条数",
                        "type": "integer"
                    }
                }
            },
            "Mapping": {
                "description": "关联规则",
                "required": [
                    "target_property",
                    "source_property"
                ],
                "type": "object",
                "properties": {
                    "target_property": {
                        "$ref": "#/components/schemas/SimpleProperty",
                        "description": "起点属性"
                    },
                    "source_property": {
                        "$ref": "#/components/schemas/SimpleProperty",
                        "description": "终点属性"
                    }
                }
            },
            "SimpleProperty": {
                "description": "属性简单信息",
                "required": [
                    "name"
                ],
                "type": "object",
                "properties": {
                    "name": {
                        "description": "属性名称",
                        "type": "string"
                    },
                    "display_name": {
                        "description": "属性显示名。当查看详情时会返回此字段",
                        "type": "string"
                    }
                }
            },
            "SimpleObjectType": {
                "description": "",
                "required": [
                    "id",
                    "name",
                    "icon",
                    "color"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "description": "对象类id",
                        "type": "string"
                    },
                    "name": {
                        "description": "对象类名称",
                        "type": "string"
                    },
                    "icon": {
                        "description": "对象类图标",
                        "type": "string"
                    },
                    "color": {
                        "description": "对象类颜色",
                        "type": "string"
                    }
                }
            },
            "Path": {
                "description": "路径",
                "required": [
                    "nodes",
                    "edges",
                    "length"
                ],
                "type": "object",
                "properties": {
                    "nodes": {
                        "description": "路径中的节点列表(有序)",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ObjectTypeDetail"
                        }
                    },
                    "edges": {
                        "description": "路径中的边列表(有序)",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/RelationTypeDetail"
                        }
                    },
                    "length": {
                        "description": "路径长度(边数量)",
                        "type": "integer"
                    }
                }
            },
            "ObjectTypeDetail": {
                "description": "节点（对象类）信息",
                "required": [
                    "id",
                    "name",
                    "comment",
                    "tags",
                    "kn_id",
                    "groups",
                    "data_source",
                    "data_properties",
                    "primary_keys",
                    "display_key",
                    "type",
                    "module_type",
                    "branch",
                    "color",
                    "icon",
                    "logic_properties",
                    "concept_groups",
                    "creator",
                    "update_time",
                    "updater",
                    "create_time"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "description": "对象类ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "对象类名称",
                        "type": "string"
                    },
                    "tags": {
                        "description": "标签。 （可以为空）",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "comment": {
                        "description": "备注（可以为空）",
                        "type": "string"
                    },
                    "icon": {
                        "description": "图标",
                        "type": "string"
                    },
                    "color": {
                        "description": "颜色",
                        "type": "string"
                    },
                    "branch": {
                        "description": "分支ID",
                        "type": "string"
                    },
                    "kn_id": {
                        "description": "业务知识网络id",
                        "type": "string"
                    },
                    "concept_groups": {
                        "description": "概念分组id",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ConceptGroup"
                        }
                    },
                    "data_source": {
                        "$ref": "#/components/schemas/DataSource",
                        "description": "数据来源"
                    },
                    "data_properties": {
                        "description": "数据属性",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/DataProperty"
                        }
                    },
                    "logic_properties": {
                        "description": "逻辑属性",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/LogicProperty"
                        }
                    },
                    "primary_keys": {
                        "description": "主键",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "display_key": {
                        "description": "对象实例的显示属性",
                        "type": "string"
                    },
                    "creator": {
                        "description": "创建人ID",
                        "type": "string"
                    },
                    "create_time": {
                        "format": "int64",
                        "description": "创建时间",
                        "type": "integer"
                    },
                    "updater": {
                        "description": "最近一次修改人",
                        "type": "string"
                    },
                    "update_time": {
                        "format": "int64",
                        "description": "最近一次更新时间",
                        "type": "integer"
                    },
                    "module_type": {
                        "description": "模块类型",
                        "enum": [
                            "object_type"
                        ],
                        "type": "string"
                    }
                }
            },
            "DataProperty": {
                "description": "数据属性",
                "required": [
                    "name",
                    "display_name",
                    "type",
                    "comment",
                    "mapped_field",
                    "index",
                    "fulltext_config",
                    "vector_config"
                ],
                "type": "object",
                "properties": {
                    "name": {
                        "description": "属性名称。只能包含小写英文字母、数字、下划线（_）、连字符（-），且不能以下划线和连字符开头",
                        "type": "string"
                    },
                    "display_name": {
                        "description": "属性显示名",
                        "type": "string"
                    },
                    "type": {
                        "description": "属性数据类型。除了视图的字段类型之外，还有 metric、objective、event、trace、log、operator",
                        "type": "string"
                    },
                    "comment": {
                        "description": "属性描述",
                        "type": "string"
                    },
                    "mapped_field": {
                        "$ref": "#/components/schemas/ViewField",
                        "description": "属性映射到数据来源中的字段名"
                    },
                    "index": {
                        "description": "是否开启索引，默认是true",
                        "type": "boolean"
                    },
                    "fulltext_config": {
                        "$ref": "#/components/schemas/FulltextConfig",
                        "description": "全文索引的配置"
                    },
                    "vector_config": {
                        "$ref": "#/components/schemas/VectorConfig",
                        "description": "向量索引的配置"
                    }
                }
            },
            "FulltextConfig": {
                "description": "全文索引的配置",
                "required": [
                    "analyzer",
                    "field_keyword"
                ],
                "type": "object",
                "properties": {
                    "analyzer": {
                        "description": "分词器",
                        "enum": [
                            "standard",
                            "ik_max_word"
                        ],
                        "type": "string"
                    },
                    "field_keyword": {
                        "description": "是否保留原始字符串，保留原始字符串可用于精确匹配。默认是false",
                        "type": "boolean"
                    }
                }
            },
            "ViewField": {
                "description": "视图字段信息",
                "required": [
                    "name"
                ],
                "type": "object",
                "properties": {
                    "name": {
                        "description": "字段名称",
                        "type": "string"
                    },
                    "display_name": {
                        "description": "字段显示名.查看时有此字段",
                        "type": "string"
                    },
                    "type": {
                        "description": "视图字段类型，查看时有此字段",
                        "type": "string"
                    }
                }
            },
            "VectorConfig": {
                "description": "向量索引的配置",
                "required": [
                    "dimension"
                ],
                "type": "object",
                "properties": {
                    "dimension": {
                        "description": "向量维度",
                        "type": "integer"
                    }
                }
            },
            "LogicProperty": {
                "description": "逻辑属性",
                "required": [
                    "name",
                    "data_source",
                    "parameters"
                ],
                "type": "object",
                "properties": {
                    "name": {
                        "description": "属性名称。只能包含小写英文字母、数字、下划线（_）、连字符（-），且不能以下划线和连字符开头",
                        "type": "string"
                    },
                    "display_name": {
                        "description": "属性显示名",
                        "type": "string"
                    },
                    "type": {
                        "description": "属性数据类型。除了视图的字段类型之外，还有 metric、objective、event、trace、log、operator",
                        "type": "string"
                    },
                    "comment": {
                        "description": "属性描述",
                        "type": "string"
                    },
                    "index": {
                        "description": "是否开启索引，默认是true",
                        "type": "boolean"
                    },
                    "data_source": {
                        "$ref": "#/components/schemas/LogicSource",
                        "description": "逻辑来源"
                    },
                    "parameters": {
                        "description": "逻辑所需的参数",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/Parameter"
                        }
                    }
                }
            },
            "LogicSource": {
                "description": "数据来源",
                "required": [
                    "type",
                    "id"
                ],
                "type": "object",
                "properties": {
                    "type": {
                        "description": "数据来源类型",
                        "enum": [
                            "metric",
                            "operator"
                        ],
                        "type": "string"
                    },
                    "id": {
                        "description": "数据来源ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "名称。查看详情时返回。",
                        "type": "string"
                    }
                }
            },
            "Parameter": {
                "description": "逻辑参数",
                "required": [
                    "name",
                    "value_from"
                ],
                "type": "object",
                "properties": {
                    "name": {
                        "description": "参数名称",
                        "type": "string"
                    },
                    "value_from": {
                        "description": "值来源",
                        "enum": [
                            "property",
                            "input"
                        ],
                        "type": "string"
                    },
                    "value": {
                        "description": "参数值。value_from=property时，填入的是对象类的数据属性名称；value_from=input时，不设置此字段",
                        "type": "string"
                    }
                }
            },
            "override": {
                "oneOf": [
                    {
                        "type": "object"
                    },
                    {
                        "$ref": "#/components/schemas/ReqRelationTypes"
                    },
                    {
                        "$ref": "#/components/schemas/override--get"
                    }
                ],
                "discriminator": {
                    "mapping": {
                        "x-http-method-override:POST": "#/components/schemas/ReqRelationTypes",
                        "x-http-method-override:GET": "#/components/schemas/override--get"
                    },
                    "propertyName\"": "x-http-method-override"
                },
                "description": "post 重载批量创建、关系类检索接口",
                "type": "object"
            },
            "ReqRelationTypes": {
                "description": "批量创建请求体",
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/ReqRelationType"
                }
            },
            "override--get": {
                "oneOf": [
                    {
                        "$ref": "#/components/schemas/FirstQueryWithSearchAfter"
                    },
                    {
                        "$ref": "#/components/schemas/PageTurnQueryWithSearchAfter"
                    }
                ],
                "description": "关系类检索请求体",
                "type": "object"
            },
            "FirstQueryWithSearchAfter": {
                "description": "关系类检索第一次请求",
                "required": [
                    "condition",
                    "limit"
                ],
                "type": "object",
                "properties": {
                    "condition": {
                        "$ref": "#/components/schemas/Condition",
                        "description": "关系类检索条件"
                    },
                    "sort": {
                        "$ref": "#/components/schemas/Sort",
                        "description": "排序字段，默认使用 _score 排序，排序方向为 desc"
                    },
                    "limit": {
                        "description": "返回的数量，默认值 10。范围 1-10000",
                        "type": "integer"
                    },
                    "need_total": {
                        "description": "是否需要总数，默认false",
                        "type": "boolean"
                    }
                }
            },
            "Condition": {
                "description": "概念查询数据条件。可用于过滤的字段有类名、属性名和描述",
                "required": [
                    "operation"
                ],
                "type": "object",
                "properties": {
                    "field": {
                        "description": "字段名称。当需要做向量检索时，字段为 *, 操作符为 knn",
                        "enum": [
                            "id",
                            "name",
                            "comment",
                            "detail",
                            "*"
                        ],
                        "type": "string"
                    },
                    "operation": {
                        "description": "操作符。\n\nknn: 未对原文进行向量化的向量过滤，接收的值是数组，第一个值，过滤内容，第二个值为 int,是邻居搜索时返回的邻居个数。\n\nknn_vector: 对原文进行向量化后的向量过滤，接收的值是数组，第一个值，向量，第二个值为 int,是邻居搜索时返回的邻居个数。",
                        "enum": [
                            "and",
                            "or",
                            "==",
                            "!=",
                            "in",
                            "not_in",
                            "like",
                            "not_like",
                            "regex",
                            "match",
                            "match_phrase",
                            "knn"
                        ],
                        "type": "string"
                    },
                    "sub_conditions": {
                        "description": "子过滤条件",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/Condition"
                        }
                    },
                    "value": {
                        "description": "字段值"
                    },
                    "value_from": {
                        "description": "字段值来源，当前仅支持 \"const\"",
                        "enum": [
                            "const"
                        ],
                        "type": "string"
                    }
                }
            },
            "Sort": {
                "description": "排序字段。默认按 _score 倒序排序",
                "required": [
                    "field",
                    "direction"
                ],
                "type": "object",
                "properties": {
                    "field": {
                        "description": "排序字段",
                        "type": "string"
                    },
                    "direction": {
                        "description": "排序方向",
                        "enum": [
                            "desc",
                            "asc"
                        ],
                        "type": "string"
                    }
                }
            },
            "PageTurnQueryWithSearchAfter": {
                "description": "分页查询的后续分页查询请求",
                "required": [
                    "limit",
                    "search_after",
                    "condition"
                ],
                "type": "object",
                "properties": {
                    "condition": {
                        "$ref": "#/components/schemas/Condition",
                        "description": "过滤条件"
                    },
                    "sort": {
                        "$ref": "#/components/schemas/Sort",
                        "description": "排序字段，默认使用 _score 排序，排序方向为 desc"
                    },
                    "limit": {
                        "description": "返回的数量，默认值 10。范围 1-10000",
                        "type": "integer"
                    },
                    "need_total": {
                        "description": "是否需要总数，默认false",
                        "type": "boolean"
                    },
                    "search_after": {
                        "description": "上次查询返回的最后一个文档的排序值。",
                        "type": "array",
                        "items": {

                        }
                    }
                }
            },
            "DirectMappingRules": {
                "description": "直接关联",
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/Mapping"
                }
            },
            "ReqRelationType": {
                "description": "关系类创建信息",
                "required": [
                    "name",
                    "branch",
                    "base_version"
                ],
                "type": "object",
                "properties": {
                    "id": {
                        "description": "ID.新建后不可修改，只能包含小写英文字母、数字、下划线（_）、连字符（-），且不能以下划线和连字符开头",
                        "type": "string"
                    },
                    "name": {
                        "description": "名称",
                        "type": "string"
                    },
                    "tags": {
                        "description": "标签。用于业务标识",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "comment": {
                        "description": "备注",
                        "type": "string"
                    },
                    "icon": {
                        "description": "图标",
                        "type": "string"
                    },
                    "color": {
                        "description": "颜色",
                        "type": "string"
                    },
                    "branch": {
                        "description": "分支ID",
                        "type": "string"
                    },
                    "concept_groups": {
                        "description": "概念分组",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "source_object_type_id": {
                        "description": "起点象类ID",
                        "type": "string"
                    },
                    "target_object_type_id": {
                        "description": "终点对象类ID",
                        "type": "string"
                    },
                    "type": {
                        "description": "关系类型",
                        "enum": [
                            "direct",
                            "data_view"
                        ],
                        "type": "string"
                    },
                    "mapping_rules": {
                        "oneOf": [
                            {
                                "$ref": "#/components/schemas/DirectMappingRules"
                            },
                            {
                                "$ref": "#/components/schemas/DataViewMappingRule"
                            }
                        ],
                        "description": "映射规则，直接映射时，是Mapping的数组"
                    }
                }
            },
            "UpdateRelationType": {
                "description": "关系类更新信息",
                "required": [
                    "name",
                    "branch",
                    "base_version",
                    "source_object_type",
                    "target_object_type"
                ],
                "type": "object",
                "properties": {
                    "name": {
                        "description": "名称",
                        "type": "string"
                    },
                    "tags": {
                        "description": "标签。用于业务标识",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "comment": {
                        "description": "备注",
                        "type": "string"
                    },
                    "icon": {
                        "description": "图标",
                        "type": "string"
                    },
                    "color": {
                        "description": "颜色",
                        "type": "string"
                    },
                    "branch": {
                        "description": "分支ID",
                        "type": "string"
                    },
                    "concept_groups": {
                        "description": "概念分组",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "source_object_type_id": {
                        "description": "起点象类ID",
                        "type": "string"
                    },
                    "target_object_type_id": {
                        "description": "终点对象类ID",
                        "type": "string"
                    },
                    "type": {
                        "description": "关系类型",
                        "enum": [
                            "direct",
                            "data_view"
                        ],
                        "type": "string"
                    },
                    "mapping_rules": {
                        "oneOf": [
                            {
                                "$ref": "#/components/schemas/DirectMappingRules"
                            },
                            {
                                "$ref": "#/components/schemas/DataViewMappingRule"
                            }
                        ],
                        "description": "关联的匹配规则。直接映射时，是Mapping的数组；间接关联时参考DataViewMappingRule"
                    }
                }
            },
            "RelationTypeDetail": {
                "description": "关系类",
                "required": [
                    "source_object_type",
                    "target_object_type",
                    "type",
                    "direct_mapping_rules",
                    "comment",
                    "data_view_mapping_rules",
                    "groups",
                    "id",
                    "kn_id",
                    "name",
                    "tags",
                    "concept_type",
                    "branch",
                    "color",
                    "concept_groups",
                    "icon",
                    "mapping_rules",
                    "source_object_type_id",
                    "target_object_type_id",
                    "create_time",
                    "creator",
                    "updater",
                    "update_time"
                ],
                "type": "object",
                "properties": {
                    "concept_type": {
                        "description": "概念类型",
                        "enum": [
                            "relation_type"
                        ],
                        "type": "string"
                    },
                    "id": {
                        "description": "关系类ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "关系类名称",
                        "type": "string"
                    },
                    "tags": {
                        "description": "标签。 （可以为空）",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "comment": {
                        "description": "备注（可以为空）",
                        "type": "string"
                    },
                    "icon": {
                        "description": "图标",
                        "type": "string"
                    },
                    "color": {
                        "description": "颜色",
                        "type": "string"
                    },
                    "branch": {
                        "description": "分支ID",
                        "type": "string"
                    },
                    "kn_id": {
                        "description": "业务知识网络ID",
                        "type": "string"
                    },
                    "concept_groups": {
                        "description": "概念分组",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ConceptGroup"
                        }
                    },
                    "source_object_type_id": {
                        "description": "起点象类ID",
                        "type": "string"
                    },
                    "source_object_type": {
                        "$ref": "#/components/schemas/SimpleObjectType",
                        "description": "起点象类名称，当查看详情时，此字段才会返回。"
                    },
                    "target_object_type_id": {
                        "description": "终点对象类ID",
                        "type": "string"
                    },
                    "target_object_type": {
                        "$ref": "#/components/schemas/SimpleObjectType",
                        "description": "终点对象类名称，当查看详情时，此字段才会返回"
                    },
                    "type": {
                        "description": "关系类型",
                        "enum": [
                            "direct",
                            "data_view"
                        ],
                        "type": "string"
                    },
                    "mapping_rules": {
                        "oneOf": [
                            {
                                "$ref": "#/components/schemas/DirectMappingRules"
                            },
                            {
                                "$ref": "#/components/schemas/DataViewMappingRule"
                            }
                        ],
                        "description": "关联的匹配规则。直接映射时，是Mapping的数组；间接关联时参考DataViewMappingRule"
                    },
                    "creator": {
                        "description": "创建人ID",
                        "type": "string"
                    },
                    "create_time": {
                        "format": "int64",
                        "description": "创建时间",
                        "type": "integer"
                    },
                    "updater": {
                        "description": "最近一次修改人",
                        "type": "string"
                    },
                    "update_time": {
                        "format": "int64",
                        "description": "最近一次更新时间",
                        "type": "integer"
                    },
                    "detail": {
                        "description": "说明书。按需返回，若指定了include_detail=true，则返回，否则不返回。列表查询时不返回此字段。",
                        "type": "string"
                    }
                }
            },
            "RelationType": {
                "description": "关系类",
                "required": [
                    "source_object_type",
                    "target_object_type",
                    "type",
                    "direct_mapping_rules",
                    "comment",
                    "data_view_mapping_rules",
                    "groups",
                    "id",
                    "kn_id",
                    "name",
                    "tags",
                    "concept_type",
                    "branch",
                    "color",
                    "concept_groups",
                    "icon",
                    "mapping_rules",
                    "source_object_type_id",
                    "target_object_type_id",
                    "create_time",
                    "creator",
                    "updater",
                    "update_time"
                ],
                "type": "object",
                "properties": {
                    "concept_type": {
                        "description": "概念类型",
                        "enum": [
                            "relation_type"
                        ],
                        "type": "string"
                    },
                    "id": {
                        "description": "关系类ID",
                        "type": "string"
                    },
                    "name": {
                        "description": "关系类名称",
                        "type": "string"
                    },
                    "tags": {
                        "description": "标签。 （可以为空）",
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "comment": {
                        "description": "备注（可以为空）",
                        "type": "string"
                    },
                    "icon": {
                        "description": "图标",
                        "type": "string"
                    },
                    "color": {
                        "description": "颜色",
                        "type": "string"
                    },
                    "branch": {
                        "description": "分支ID",
                        "type": "string"
                    },
                    "kn_id": {
                        "description": "业务知识网络ID",
                        "type": "string"
                    },
                    "concept_groups": {
                        "description": "概念分组",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ConceptGroup"
                        }
                    },
                    "source_object_type_id": {
                        "description": "起点象类ID",
                        "type": "string"
                    },
                    "target_object_type_id": {
                        "description": "终点对象类ID",
                        "type": "string"
                    },
                    "type": {
                        "description": "关系类型",
                        "enum": [
                            "direct",
                            "data_view"
                        ],
                        "type": "string"
                    },
                    "mapping_rules": {
                        "oneOf": [
                            {
                                "$ref": "#/components/schemas/DirectMappingRules"
                            },
                            {
                                "$ref": "#/components/schemas/DataViewMappingRule"
                            }
                        ],
                        "description": "关联的匹配规则。直接映射时，是Mapping的数组；间接关联时参考DataViewMappingRule"
                    },
                    "creator": {
                        "description": "创建人ID",
                        "type": "string"
                    },
                    "create_time": {
                        "format": "int64",
                        "description": "创建时间",
                        "type": "integer"
                    },
                    "updater": {
                        "description": "最近一次修改人",
                        "type": "string"
                    },
                    "update_time": {
                        "format": "int64",
                        "description": "最近一次更新时间",
                        "type": "integer"
                    },
                    "detail": {
                        "description": "说明书。按需返回，若指定了include_detail=true，则返回，否则不返回。列表查询时不返回此字段。",
                        "type": "string"
                    }
                }
            },
            "RelationTypeSearchResponse": {
                "description": "关系类检索返回结果",
                "required": [
                    "groups",
                    "type",
                    "entries",
                    "search_after"
                ],
                "type": "object",
                "properties": {
                    "entries": {
                        "description": "对象实例数据",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/RelationTypeDetail"
                        }
                    },
                    "total_count": {
                        "description": "总条数",
                        "type": "integer"
                    },
                    "search_after": {
                        "description": "表示返回的最后一个文档的排序值，获取这个用于下一次 search_after 分页。",
                        "type": "array",
                        "items": {

                        }
                    }
                }
            }
        }
    }
}